---
title: "Wine Sales"
author: "Biguzzi, Connin, Greenlee, Moscoe, Sooklall, Telab, and Wright"
date: "11/05/2021"
output:
  word_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.width = 7)
```

```{r, include = FALSE}
library(skimr) # for dataset summaries
library(finalfit) # for missingness patterns
library(dplyr)

raw <- read.csv("https://raw.githubusercontent.com/rachel-greenlee/data621/main/HW5_count/wine-training-data.csv")
eval <- read.csv("https://raw.githubusercontent.com/rachel-greenlee/data621/main/HW5_count/wine-evaluation-data.csv")
```


## Introduction

Using the information about sample wine orders by restaurants and wine stores after a tasting, how can we predict wine sales by various wine characteristics? Using the `wine` dataset with 12,000 entries and variables mostly related to the chemical properties of each wine, we will build a count regression model to predict the number of cases of wine that will be sold. In practice, if a wine manufacturer can predict which wines will lead to greater sales, they can choose to offer those at more tastings in restaurants and wine stores.

In this report we will:

* explore the data
* transform the data to meet conditions of count modeling
* compare models
* select an optimal model
* generate predictions for the evaluation data set


## Data Exploration

As part of our initial data exploration we want to look at the following key diagnostics:  

####### update as sections fill in below


### Distribution

Using the skimr package we take a look at the raw dataset. There are 12,795 cases and 14 potential predictor variables. All variables are numeric.  

With regards to missingness, we have 6 variables with data for every case. This leaves 8 variables that have some degree of missing data, with the worst being the `STARS` variable with only 73.7% of cases having a value for `STARS` (the wine rating by experts). 


```{r, skimr_digits = 0}
skim_without_charts(raw)
```



Looking for patterns in missingness can be telling, we use the missing package to visualize the missing data.

```{r}
raw %>%
  missing_plot()
```


```{r, fig.width= 9}
explanatory = c("TotalSulfurDioxide", "pH", "ResidualSugar",
                "Chloride", "FreeSulfurDioxide",
                "Sulphates", "Alcohol", "STARS")
dependent = "TARGET"

missing_table <- raw %>% 
  missing_pattern(dependent, explanatory, plot = FALSE)

missing_table <- as.data.frame(missing_table, row.names = NULL)

?as.data.frame

missing_table <- arrange(missing_table, V9)
missing_table


```




